"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[3840],{66262:(i,s)=>{s.A=(i,s)=>{const a=i.__vccOpts||i;for(const[i,e]of s)a[i]=e;return a}},50996:(i,s,a)=>{a.r(s),a.d(s,{comp:()=>l,data:()=>n});var e=a(20641);const t={},l=(0,a(66262).A)(t,[["render",function(i,s){return(0,e.uX)(),(0,e.CE)("div",null,s[0]||(s[0]=[(0,e.Fv)('<h1 id="_9-3-1-初识promql" tabindex="-1"><a class="header-anchor" href="#_9-3-1-初识promql"><span>9.3.1 初识PromQL</span></a></h1><h2 id="一、几种常见的promql语句" tabindex="-1"><a class="header-anchor" href="#一、几种常见的promql语句"><span>一、几种常见的PromQL语句</span></a></h2><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 1、查询HTTP请求总数</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">http_requests_total</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 2、条件查询：查询状态码为200多请求总数</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">http_requests_total</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">{method=</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&quot;POST&quot;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">,status</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&quot;200&quot;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">}</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 3、区间查询：查询5分钟内的请求总量</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">http_requests_total</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">{}</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">[5m]</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 4、系统函数使用：查询系统所有HTTP请求的总和</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sum(http_requests_total</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 5、函数rate，以1次/秒的速率采集最近5分钟内的数据并将结果以时间序列的形式返回</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rate(http_requests_total[5m]</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>PromQL的4种数据类型</strong></p><ul><li>瞬时向量：每个时间序列包含单个样本</li><li>区间向量：每个时间序列包含一段时间范围内的样本数据</li><li>标量：一个浮点型的数据值，没有时序</li><li>字符串：一个简单的字符串值</li></ul><h2 id="二、时间序列" tabindex="-1"><a class="header-anchor" href="#二、时间序列"><span>二、时间序列</span></a></h2><p>时间序列数据库主要按照一定的时间间隔产生一个个样本，而这些样本按照时间戳和值的生成顺序存放。</p><p>每条时间序列是通过指标名称和一组标签集来命名的。如果时间戳相同，但是指标名称或者标签集不同，那么时间序列也不同。</p><p>样本的主要构成：</p><ul><li>指标：包括指标名称和标签</li><li>时间戳：精确到毫秒</li><li>样本值：默认Float64浮点类型</li></ul><h3 id="三、指标" tabindex="-1"><a class="header-anchor" href="#三、指标"><span>三、指标</span></a></h3><p>时间序列的指标基于K-V的方式存放。</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>Key：Metric Name + Label + Timestamp</span></span>\n<span class="line"><span>Value：Sample Value</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>例如：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>http_requests_total{method=&quot;POST&quot;, status=&quot;200&quot;}@1750495216225 =&gt; 1904</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><code>1904</code>作为Value，<code>http_requests_total{method=&quot;POST&quot;, status=&quot;200&quot;}@1750495216225</code>作为Key</p>',16)]))}]]),n=JSON.parse('{"path":"/%E4%B9%9D%E3%80%81prometheus/9.3%20PromQL%E8%AE%A9%E6%95%B0%E6%8D%AE%E4%BC%9A%E8%AF%B4%E8%AF%9D/9.3.1%20%E5%88%9D%E8%AF%86PromQL.html","title":"9.3.1 初识PromQL","lang":"zh-CN","frontmatter":{"\x3c!--cover":"/assets/images/cover2.jpg--\x3e","icon":"pen-to-square","date":"2025-05-21T00:00:00.000Z","category":["Prometheus"],"star":true,"ticky":true,"description":"9.3.1 初识PromQL 一、几种常见的PromQL语句 PromQL的4种数据类型 瞬时向量：每个时间序列包含单个样本 区间向量：每个时间序列包含一段时间范围内的样本数据 标量：一个浮点型的数据值，没有时序 字符串：一个简单的字符串值 二、时间序列 时间序列数据库主要按照一定的时间间隔产生一个个样本，而这些样本按照时间戳和值的生成顺序存放。 每条...","head":[["meta",{"property":"og:url","content":"https://mister-hope.github.io/myBlog/%E4%B9%9D%E3%80%81prometheus/9.3%20PromQL%E8%AE%A9%E6%95%B0%E6%8D%AE%E4%BC%9A%E8%AF%B4%E8%AF%9D/9.3.1%20%E5%88%9D%E8%AF%86PromQL.html"}],["meta",{"property":"og:site_name","content":"Java笔记"}],["meta",{"property":"og:title","content":"9.3.1 初识PromQL"}],["meta",{"property":"og:description","content":"9.3.1 初识PromQL 一、几种常见的PromQL语句 PromQL的4种数据类型 瞬时向量：每个时间序列包含单个样本 区间向量：每个时间序列包含一段时间范围内的样本数据 标量：一个浮点型的数据值，没有时序 字符串：一个简单的字符串值 二、时间序列 时间序列数据库主要按照一定的时间间隔产生一个个样本，而这些样本按照时间戳和值的生成顺序存放。 每条..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2026-02-20T02:39:46.000Z"}],["meta",{"property":"article:published_time","content":"2025-05-21T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2026-02-20T02:39:46.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"9.3.1 初识PromQL\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2025-05-21T00:00:00.000Z\\",\\"dateModified\\":\\"2026-02-20T02:39:46.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"冉庆\\",\\"url\\":\\"https://mister-hope.com\\"}]}"]]},"headers":[{"level":2,"title":"一、几种常见的PromQL语句","slug":"一、几种常见的promql语句","link":"#一、几种常见的promql语句","children":[]},{"level":2,"title":"二、时间序列","slug":"二、时间序列","link":"#二、时间序列","children":[{"level":3,"title":"三、指标","slug":"三、指标","link":"#三、指标","children":[]}]}],"git":{"createdTime":1771555186000,"updatedTime":1771555186000,"contributors":[{"name":"ranqing","email":"2516488782@qq.com","commits":1}]},"readingTime":{"minutes":1.34,"words":401},"filePathRelative":"九、prometheus/9.3 PromQL让数据会说话/9.3.1 初识PromQL.md","localizedDate":"2025年5月21日","excerpt":"\\n<h2>一、几种常见的PromQL语句</h2>\\n<div class=\\"language-shell line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"shell\\" data-title=\\"shell\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\"># 1、查询HTTP请求总数</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">http_requests_total</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\"># 2、条件查询：查询状态码为200多请求总数</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">http_requests_total</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">{method=</span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\"POST\\"</span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">,status</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">=</span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\"200\\"</span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">}</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\"># 3、区间查询：查询5分钟内的请求总量</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">http_requests_total</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">{}</span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">[5m]</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\"># 4、系统函数使用：查询系统所有HTTP请求的总和</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">sum(http_requests_total</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">)</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\"># 5、函数rate，以1次/秒的速率采集最近5分钟内的数据并将结果以时间序列的形式返回</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">rate(http_requests_total[5m]</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">)</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}')}}]);