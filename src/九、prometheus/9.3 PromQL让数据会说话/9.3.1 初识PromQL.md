---
<!--cover: /assets/images/cover2.jpg-->
icon: pen-to-square
date: 2025-05-21
category:
  - Prometheus
star: true
ticky: true
---
# 9.3.1 初识PromQL

## 一、几种常见的PromQL语句

```shell
# 1、查询HTTP请求总数
http_requests_total

# 2、条件查询：查询状态码为200多请求总数
http_requests_total{method="POST",status="200"}

# 3、区间查询：查询5分钟内的请求总量
http_requests_total{}[5m]

# 4、系统函数使用：查询系统所有HTTP请求的总和
sum(http_requests_total)

# 5、函数rate，以1次/秒的速率采集最近5分钟内的数据并将结果以时间序列的形式返回
rate(http_requests_total[5m])
```

**PromQL的4种数据类型**

- 瞬时向量：每个时间序列包含单个样本
- 区间向量：每个时间序列包含一段时间范围内的样本数据
- 标量：一个浮点型的数据值，没有时序
- 字符串：一个简单的字符串值

## 二、时间序列

时间序列数据库主要按照一定的时间间隔产生一个个样本，而这些样本按照时间戳和值的生成顺序存放。

每条时间序列是通过指标名称和一组标签集来命名的。如果时间戳相同，但是指标名称或者标签集不同，那么时间序列也不同。

样本的主要构成：

- 指标：包括指标名称和标签
- 时间戳：精确到毫秒
- 样本值：默认Float64浮点类型

### 三、指标

时间序列的指标基于K-V的方式存放。

```
Key：Metric Name + Label + Timestamp
Value：Sample Value
```

例如：

```
http_requests_total{method="POST", status="200"}@1750495216225 => 1904
```

`1904`作为Value，`http_requests_total{method="POST", status="200"}@1750495216225`作为Key















