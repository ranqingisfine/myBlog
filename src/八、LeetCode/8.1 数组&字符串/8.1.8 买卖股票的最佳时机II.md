---
<!--cover: /assets/images/cover2.jpg-->
icon: pen-to-square
date: 2025-02-24
category:
  - LeetCode 
tag:
  - 动态规划 
star: true 
ticky: true


---

# 8.1.8 买卖股票的最佳时机II

**题目**：给你一个整数数组 `prices` ，其中 `prices[i]` 表示某支股票第 `i` 天的价格。

在每一天，你可以决定是否购买和/或出售股票。你在任何时候 **最多** 只能持有 **一股** 股票。然而，你可以在 **同一天** 多次买卖该股票，但要确保你持有的股票不超过一股。

返回 *你能获得的 **最大** 利润* 。



**理解题意**：

- 任何时候 **最多** 只能持有 **一股** 股票：不能买多股，保证买股票的钱=1股*股价
-  **同一天** 多次买卖该股：每天可以买、可以卖，甚至**同一天先卖再买**（但不能同时持有多股）

**分析**：

- 不用纠结 “哪天买哪天卖”，核心是**抓住所有价格上涨的区间**（只要后一天比前一天贵，就有利润可赚）；

- “持有到最后卖” 和 “每天高抛低吸” 的总利润相等，累加所有上涨差价就对了，证明：

- 假设股票价格在连续上涨区间的价格是：`p0, p1, p2, ..., pn`（其中 p1>p0、p2>p1、…、pn>pn-1）。

  - **一次性买卖的利润**：pn - p0；
  - **拆分买卖的利润**：(p1-p0) + (p2-p1) + (p3-p2) + ... + (pn-pn-1)。

  我们把拆分买卖的式子展开：

  (p1-p0) + (p2-p1) + (p3-p2) + ... + (pn-pn-1)

  = p1 - p0 + p2 - p1 + p3 - p2 + ... + pn - pn-1

  会发现，中间的 p1、p2、…、pn-1 全部抵消了，最后只剩下 `pn - p0` —— 和一次性买卖的利润完全相等

**代码**：

```java
class Solution {
    public int maxProfit(int[] prices) {
        int n = prices.length;
        int profit = 0;
        for (int i = 1; i < n; i++) {
            profit+=Math.max(prices[i]-prices[i-1],0);
        }
        return profit;
    }
}
```



